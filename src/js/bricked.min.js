var PaddleAi;PaddleAi=function(){function b(a,b){this.paddle=a,this.learner=b}var a;return b.prototype.applyXForce=function(a){var b,c,d;return b=Box2D.Common.Math.b2Vec2,c=this.paddle.GetPosition(),d=new b(a,0),this.paddle.ApplyForce(d,c)},b.prototype.moveLeft=function(){return this.applyXForce(-5)},b.prototype.moveRight=function(){return this.applyXForce(5)},b.prototype.updateGoalX=function(){return this.goalX=a.ball.GetPosition().x},b.prototype.update=function(){var a;this.updateGoalX(),a=this.paddle.GetPosition().x;if(a<this.goalX)return this.moveRight();if(a>this.goalX)return this.moveLeft()},a={},a.stats=new Stats,document.body.appendChild(a.stats.domElement),a.canvas=document.getElementById("c"),a.ctx=a.canvas.getContext("2d"),a.SCALE=30,a.FRAME_RATE=1/60,a.VELOCITY_ITERATIONS=10,a.POSITION_ITERATIONS=10,a.GRAVITY=new Box2D.Common.Math.b2Vec2(0,0),a.WIDTH=a.canvas.width,a.HEIGHT=a.canvas.height,a.BALL_RADIUS=10,window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a,b){return window.setTimeout(a,1e3/60)}}(),a.scaleToPhys=function(b){return b/a.SCALE},a.scaleVecToPhys=function(b){return b.Multiply(1/a.SCALE),b},a.scaleToScreen=function(b){return b*a.SCALE},a.createWalls=function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o;return c=Box2D.Dynamics.b2BodyDef,b=Box2D.Dynamics.b2Body,d=Box2D.Dynamics.b2FixtureDef,e=Box2D.Collision.Shapes.b2PolygonShape,i=new d,i.density=1,i.friction=0,i.restitution=.2,f=new c,f.type=b.b2_staticBody,i.shape=new e,f.position.x=0,f.position.y=a.scaleToPhys(a.HEIGHT/2),k=a.scaleToPhys(5),j=a.scaleToPhys((a.HEIGHT+10*a.BALL_RADIUS)/2),i.shape.SetAsBox(k,j),a.leftWall=a.world.CreateBody(f),a.leftWall.CreateFixture(i),f.position.x=a.scaleToPhys(a.WIDTH/2),f.position.y=0,o=a.scaleToPhys(a.WIDTH/2),n=a.scaleToPhys(5),i.shape.SetAsBox(o,n),a.world.CreateBody(f).CreateFixture(i),f.position.x=a.scaleToPhys(a.WIDTH),f.position.y=a.scaleToPhys(a.HEIGHT/2),m=k,l=j,i.shape.SetAsBox(m,j),a.world.CreateBody(f).CreateFixture(i),f.position.x=a.scaleToPhys(a.WIDTH/2),f.position.y=a.scaleToPhys(a.HEIGHT+5*a.BALL_RADIUS),h=o,g=n,i.shape.SetAsBox(h,n),a.bottomWall=a.world.CreateBody(f),a.bottomWall.CreateFixture(i)},a.createBall=function(){var b,c,d,e,f,g,h,i;return c=Box2D.Dynamics.b2BodyDef,b=Box2D.Dynamics.b2Body,e=Box2D.Dynamics.b2FixtureDef,d=Box2D.Collision.Shapes.b2CircleShape,h=new e,h.density=1,h.friction=0,h.restitution=1,i=a.scaleToPhys(a.BALL_RADIUS),h.shape=new d(i),g=new c,g.type=b.b2_dynamicBody,g.position.x=a.scaleToPhys(a.WIDTH/2),g.position.y=a.scaleToPhys(a.HEIGHT/2),f=a.world.CreateBody(g),f.CreateFixture(h),f.SetBullet(!0),f},a.createPaddle=function(){var b,c,d,e,f,g,h,i,j,k;return f=Box2D.Common.Math.b2Vec2,c=Box2D.Dynamics.b2BodyDef,b=Box2D.Dynamics.b2Body,d=Box2D.Dynamics.b2FixtureDef,e=Box2D.Collision.Shapes.b2PolygonShape,h=new d,h.density=1,h.friction=0,h.restitution=1,h.shape=new e,j=[a.scaleVecToPhys(new f(0,0)),a.scaleVecToPhys(new f(-40,0)),a.scaleVecToPhys(new f(-35,-4)),a.scaleVecToPhys(new f(-20,-8)),a.scaleVecToPhys(new f(-10,-10)),a.scaleVecToPhys(new f(10,-10)),a.scaleVecToPhys(new f(20,-8)),a.scaleVecToPhys(new f(35,-4)),a.scaleVecToPhys(new f(40,0))],h.shape.SetAsArray(j,j.Length),g=new c,g.type=b.b2_dynamicBody,g.position.x=a.scaleToPhys(a.WIDTH/2),g.position.y=a.scaleToPhys(a.HEIGHT-20),g.linearDamping=2,i=a.world.CreateBody(g),i.CreateFixture(h),k=new Box2D.Dynamics.Joints.b2PrismaticJointDef,k.Initialize(i,a.bottomWall,i.GetPosition(),new f(1,0)),a.world.CreateJoint(k),i},a.beginContact=function(b){var c,d;c=b.GetFixtureA().GetBody(),d=b.GetFixtureB().GetBody();if(c===a.ball&&d===a.bottomWall||c===a.bottomWall&&d===a.ball)return a.didBallDie=!0},a.createNn=function(){var a,b;return b={hidden:[16],growthRate:1,learningRate:.8},a=new brain.NeuralNetwork(b),a},a.init=function(){var c,d,e,f,g;return d=Box2D.Dynamics.b2DebugDraw,c=!0,a.world=new Box2D.Dynamics.b2World(a.GRAVITY,c),a.createWalls(),a.ball=a.createBall(),a.paddle=a.createPaddle(),g=a.createNn(),a.paddleAi=new b(a.paddle,g),f=new Box2D.Dynamics.b2ContactListener,f.BeginContact=a.beginContact,a.world.SetContactListener(f),e=new d,e.SetSprite(a.ctx),e.SetDrawScale(a.SCALE),e.SetFillAlpha(.4),e.SetLineThickness(1),e.SetFlags(d.e_shapeBit|d.e_jointBit),a.world.SetDebugDraw(e)},a.startBall=function(){var b,c,d,e,f;return b=Box2D.Common.Math.b2Vec2,e=Math.random()*200+50,f=Math.random()*200+50,Math.random()>.5&&(e*=-1),Math.random()>.5&&(f*=-1),d=new b(e,f),c=a.ball.GetPosition(),a.ball.ApplyForce(d,c)},a.update=function(){return a.world.Step(a.FRAME_RATE,a.VELOCITY_ITERATIONS,a.POSITION_ITERATIONS),a.world.DrawDebugData(),a.world.ClearForces(),a.didBallDie&&(a.didBallDie=!1,a.world.DestroyBody(a.ball),a.ball=a.createBall(),a.startBall()),a.paddleAi.update(),a.stats.update(),requestAnimFrame(a.update)},a.init(),requestAnimFrame(a.update),a.startBall(),b}()