var PaddleAi,bricked;bricked.PaddleAi=PaddleAi=function(){function a(a,b){this.paddle=a,this.learner=b,this.trainingWorker=new Worker(bricked.paths.TRAINER_WORKER),this.trainingWorker.onmessage=this.onTrainerWorkerMessage,this.predictWorld=function(){return null}}return a.prototype.onTrainerWorkerMessage=function(a){return this.predictWorld=a.data},a.prototype.applyXForce=function(a){var b,c,d;return b=Box2D.Common.Math.b2Vec2,c=this.paddle.GetPosition(),d=new b(a,0),this.paddle.ApplyForce(d,c)},a.prototype.moveLeft=function(){return this.applyXForce(-5)},a.prototype.moveRight=function(){return this.applyXForce(5)},a.prototype.updateGoalX=function(){return this.goalX=bricked.ball.GetPosition().x},a.prototype.update=function(){var a;this.updateGoalX(),a=this.paddle.GetPosition().x;if(a<this.goalX)return this.moveRight();if(a>this.goalX)return this.moveLeft()},a}(),bricked={},bricked.stats=new Stats,document.body.appendChild(bricked.stats.domElement),bricked.canvas=document.getElementById("c"),bricked.ctx=bricked.canvas.getContext("2d"),bricked.SCALE=30,bricked.FRAME_RATE=1/60,bricked.VELOCITY_ITERATIONS=10,bricked.POSITION_ITERATIONS=10,bricked.GRAVITY=new Box2D.Common.Math.b2Vec2(0,0),bricked.WIDTH=bricked.canvas.width,bricked.HEIGHT=bricked.canvas.height,bricked.BALL_RADIUS=10,bricked.paths={},bricked.paths.TRAINER_WORKER="trainerWorker.min.js",window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a,b){return window.setTimeout(a,1e3/60)}}(),bricked.scaleToPhys=function(a){return a/bricked.SCALE},bricked.scaleVecToPhys=function(a){return a.Multiply(1/bricked.SCALE),a},bricked.scaleToScreen=function(a){return a*bricked.SCALE},bricked.createWalls=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n;return b=Box2D.Dynamics.b2BodyDef,a=Box2D.Dynamics.b2Body,c=Box2D.Dynamics.b2FixtureDef,d=Box2D.Collision.Shapes.b2PolygonShape,h=new c,h.density=1,h.friction=0,h.restitution=.2,e=new b,e.type=a.b2_staticBody,h.shape=new d,e.position.x=0,e.position.y=bricked.scaleToPhys(bricked.HEIGHT/2),j=bricked.scaleToPhys(5),i=bricked.scaleToPhys((bricked.HEIGHT+10*bricked.BALL_RADIUS)/2),h.shape.SetAsBox(j,i),bricked.leftWall=bricked.world.CreateBody(e),bricked.leftWall.CreateFixture(h),e.position.x=bricked.scaleToPhys(bricked.WIDTH/2),e.position.y=0,n=bricked.scaleToPhys(bricked.WIDTH/2),m=bricked.scaleToPhys(5),h.shape.SetAsBox(n,m),bricked.world.CreateBody(e).CreateFixture(h),e.position.x=bricked.scaleToPhys(bricked.WIDTH),e.position.y=bricked.scaleToPhys(bricked.HEIGHT/2),l=j,k=i,h.shape.SetAsBox(l,i),bricked.world.CreateBody(e).CreateFixture(h),e.position.x=bricked.scaleToPhys(bricked.WIDTH/2),e.position.y=bricked.scaleToPhys(bricked.HEIGHT+5*bricked.BALL_RADIUS),g=n,f=m,h.shape.SetAsBox(g,m),bricked.bottomWall=bricked.world.CreateBody(e),bricked.bottomWall.CreateFixture(h)},bricked.createBall=function(){var a,b,c,d,e,f,g,h;return b=Box2D.Dynamics.b2BodyDef,a=Box2D.Dynamics.b2Body,d=Box2D.Dynamics.b2FixtureDef,c=Box2D.Collision.Shapes.b2CircleShape,g=new d,g.density=1,g.friction=0,g.restitution=1,h=bricked.scaleToPhys(bricked.BALL_RADIUS),g.shape=new c(h),f=new b,f.type=a.b2_dynamicBody,f.position.x=bricked.scaleToPhys(bricked.WIDTH/2),f.position.y=bricked.scaleToPhys(bricked.HEIGHT/2),e=bricked.world.CreateBody(f),e.CreateFixture(g),e.SetBullet(!0),e},bricked.createPaddle=function(){var a,b,c,d,e,f,g,h,i,j;return e=Box2D.Common.Math.b2Vec2,b=Box2D.Dynamics.b2BodyDef,a=Box2D.Dynamics.b2Body,c=Box2D.Dynamics.b2FixtureDef,d=Box2D.Collision.Shapes.b2PolygonShape,g=new c,g.density=1,g.friction=0,g.restitution=1,g.shape=new d,i=[bricked.scaleVecToPhys(new e(0,0)),bricked.scaleVecToPhys(new e(-40,0)),bricked.scaleVecToPhys(new e(-35,-4)),bricked.scaleVecToPhys(new e(-20,-8)),bricked.scaleVecToPhys(new e(-10,-10)),bricked.scaleVecToPhys(new e(10,-10)),bricked.scaleVecToPhys(new e(20,-8)),bricked.scaleVecToPhys(new e(35,-4)),bricked.scaleVecToPhys(new e(40,0))],g.shape.SetAsArray(i,i.Length),f=new b,f.type=a.b2_dynamicBody,f.position.x=bricked.scaleToPhys(bricked.WIDTH/2),f.position.y=bricked.scaleToPhys(bricked.HEIGHT-20),f.linearDamping=2,h=bricked.world.CreateBody(f),h.CreateFixture(g),j=new Box2D.Dynamics.Joints.b2PrismaticJointDef,j.Initialize(h,bricked.bottomWall,h.GetPosition(),new e(1,0)),bricked.world.CreateJoint(j),h},bricked.beginContact=function(a){var b,c;b=a.GetFixtureA().GetBody(),c=a.GetFixtureB().GetBody();if(b===bricked.ball&&c===bricked.bottomWall||b===bricked.bottomWall&&c===bricked.ball)return bricked.didBallDie=!0},bricked.createNn=function(){var a,b;return b={hidden:[16],growthRate:1,learningRate:.8},a=new brain.NeuralNetwork(b),a},bricked.init=function(){var a,b,c,d,e;return b=Box2D.Dynamics.b2DebugDraw,a=!0,bricked.world=new Box2D.Dynamics.b2World(bricked.GRAVITY,a),bricked.createWalls(),bricked.ball=bricked.createBall(),bricked.paddle=bricked.createPaddle(),e=bricked.createNn(),bricked.paddleAi=new PaddleAi(bricked.paddle,e),d=new Box2D.Dynamics.b2ContactListener,d.BeginContact=bricked.beginContact,bricked.world.SetContactListener(d),c=new b,c.SetSprite(bricked.ctx),c.SetDrawScale(bricked.SCALE),c.SetFillAlpha(.4),c.SetLineThickness(1),c.SetFlags(b.e_shapeBit|b.e_jointBit),bricked.world.SetDebugDraw(c)},bricked.startBall=function(){var a,b,c,d,e;return a=Box2D.Common.Math.b2Vec2,d=Math.random()*200+50,e=Math.random()*200+50,Math.random()>.5&&(d*=-1),Math.random()>.5&&(e*=-1),c=new a(d,e),b=bricked.ball.GetPosition(),bricked.ball.ApplyForce(c,b)},bricked.update=function(){return bricked.world.Step(bricked.FRAME_RATE,bricked.VELOCITY_ITERATIONS,bricked.POSITION_ITERATIONS),bricked.world.DrawDebugData(),bricked.world.ClearForces(),bricked.didBallDie&&(bricked.didBallDie=!1,bricked.world.DestroyBody(bricked.ball),bricked.ball=bricked.createBall(),bricked.startBall()),bricked.paddleAi.update(),bricked.stats.update(),requestAnimFrame(bricked.update)},bricked.init(),requestAnimFrame(bricked.update),bricked.startBall()